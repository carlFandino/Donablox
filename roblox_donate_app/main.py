from fastapi import FastAPI, APIRouter, Request
from fastapi.responses import HTMLResponse
from fastapi.templating import Jinja2Templates
from fastapi.staticfiles import StaticFiles

from transaction import Player

class Donablox:
	def __init__(self):
		self.user = Player("D08DA602CC6CCD86B5408BD67BE7D020CA29655312C20418E6B326C99A54515AAB5F4D6FA6DE66EE4EE7DC2D3051C06CBBFF434CE9FC8D31BC050BBE7237495F7009E1D8DF4ACF46DBBDC95B64954A680BC1D85BE0AEA622CA2C646BC956172BE8920ABA044469CF0F5FCF5115A8C4A7140F197616D74484D2C9C366465499024B6E0422F7D5F02FD653521DA88DCCD4575B0A84C137466468343ED3C705388629C0B6C7E2F24426A02DBECCB4AE0F8622B8744BEDD9B26B961AC757B31D94DA49DC28A5D09CEA1B3E0A43D3CDB4FDDC92F750D0FA853BECC86DEE3B1E69780BED0D5F10E2B706A244D1330D4D907A3BE332E57FE3F17DAA0939196E901183CE4408304DD7094F3849D69C5C2E3ED2DC5F3DBA44630629D4D4FE7955B57DABD65C03E719FB2667329978236C724F2D77ACA91BC6A7B7B23E3B0FC6CADC3C781781288583B535474D103EE6DDC8B6CCC11C3B3E48E9875894998E83E09B10DF4915D95EFC1B88CC4E7D7299AE9179BA57EABE820A3098FE410C3D6C7C5BCBC0B98C3F3E27DC6A136B5795937ABE748AC1D3D91D6694DDFF56BE95FA3787678DBD2D4AF2ED35CFFE3E6622A0FFA66731958CFDDC02")
		
		self.router = APIRouter()
		self.router.add_api_route("/", self.index, methods=["GET"], response_class=HTMLResponse)

	async def index(self, request: Request):
		await self.user.main()
		return templates.TemplateResponse("index.html", {"request": request, "donators":await self.user.get_donators()})

app = FastAPI()
app.mount("/assets", StaticFiles(directory="assets"), name="assets")
Donablox = Donablox()
templates = Jinja2Templates(directory="templates")
app.include_router(Donablox.router)